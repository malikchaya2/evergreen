#######################################
#            Functions                #
#######################################
functions:
  "generate github token": &gen_github_token
    command: github.generate_token
    params:
      owner: wiredtiger
      repo: automation-scripts
      expansion_name: generated_token
      permissions:
        metadata: read
        contents: read
  "get automation-scripts": &get_automation_scripts
    command: shell.exec
    type: setup
    params:
      shell: bash
      script: |
        set -o errexit
        set -o verbose
        echo "generated_token: ${generated_token}"
        git clone https://x-access-token:${generated_token}@github.com/wiredtiger/automation-scripts.git
  "compile wiredtiger":
    - *gen_github_token
    - *get_automation_scripts
#######################################
#                Tasks                #
#######################################

tasks:
  - name: wired-tiger-mock
    commands:
      - func: "compile wiredtiger"
#######################################
#            Buildvariants            #
#######################################
buildvariants:
  - name: ubuntu2204
    display_name: Ubuntu 22.04
    run_on:
      - ubuntu2204-small
    tasks:
      - name: wired-tiger-mock
