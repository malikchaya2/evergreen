#######################################
#                Tasks                #
#######################################

tasks:
  - name: should-fail-private-clone-no-token
    commands:
      - command: shell.exec
        params:
          script: |
            git clone https://github.com/${owner}/${repo}.git
  - name: should-pass-private-clone-with-token
    commands:
      - command: github.generate_token
        params:
          expansion_name: generated_token
      - command: shell.exec
        params:
          script: |
            git clone https://x-access-token:${generated_token}@github.com/${owner}/${repo}.git

#######################################
#            Buildvariants            #
#######################################
buildvariants:
  - name: DEVPROD-5742-ubuntu2204-small
    run_on:
      - DEVPROD-5742-ubuntu2204-small
    display_name: BV-with-no-ssh-key
    expansions:
      owner: evergreen-ci
      repo: github-merge-queue-sandbox
    tasks:
      - name: should-fail-private-clone-no-token # should fail
      - name: should-pass-private-clone-with-token # should succeed

